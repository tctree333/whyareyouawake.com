<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <style type="text/css">
        html,
        body {
            height: 100%;
            margin: 0;
            background-color: beige;
        }

        h1, p {
            font-size: 3em;
            position: absolute;
            top: 50%;
            width: 100%;
            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Tahoma, Geneva, Verdana, Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
        }

        #last {
            width: 0;
            height: 0;
            margin: 0;
            padding: 0;
        }

        .yt-p {
            max-width: 720px;
            margin-left: auto;
            margin-right: auto;
        }

        .yt {
            position: relative;
            padding-bottom: 56.25%;
            /* padding-top: 30px; */
            height: 0;
            overflow: hidden;
        }

        .yt iframe,
        .yt object,
        .yt embed {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .wrapper {
            position: relative;
            text-align: center;
            height: 100vh;
            margin-left: 4em;
            margin-right: 4em;
        }

        .footer {
            text-align: center;
            position: relative;
        }
        .footer p {
            font-size: 1.2em;
            padding: 3em 0;
        }
    </style>
    <title>Why Are You Awake?</title>
    <meta name="description" content="Why are you awake? I mean, it's 3am somewhere... You should probably go to sleep.">
    <script async defer data-domain="whyareyouawake.com" src="https://stats.whyareyouawake.com/js/index.js"></script>
</head>

<body>
    <div id="parent">
        <div class="wrapper">
            <h1>Pssst.</h1>
        </div>
        <div class="wrapper">
            <p>Yes, you there.</p>
        </div>
        <div class="wrapper">
            <p>The person that's awake, reading this.</p>
        </div>
        <div class="wrapper">
            <p>Hello!</p>
        </div>
        <div class="wrapper">
            <p>Why are you awake?</p>
        </div>
        <div class="wrapper">
            <p>I don't know what time it is for you,</p>
        </div>
        <div class="wrapper">
            <p>but it might be time to knock yourself out for the day.</p>
        </div>
        <div class="wrapper">
            <p>I mean,</p>
        </div>
        <div class="wrapper">
            <p>it's 3am somewhere, right?</p>
        </div>
        <div class="wrapper">
            <p>Or whenever you usually go to sleep.</p>
        </div>
        <div class="wrapper">
            <p>You might be thinking,</p>
        </div>
        <div class="wrapper">
            <p>"Why am I here, scrolling through this random website?"</p>
        </div>
        <div class="wrapper">
            <p>And to that, I say,</p>
        </div>
        <div class="wrapper">
            <p>Because.</p>
        </div>
        <div class="wrapper">
            <p>And that might not be a satisfying answer.</p>
        </div>
        <div class="wrapper">
            <p>You might be slightly annoyed.</p>
        </div>
        <div class="wrapper">
            <p>Or not.</p>
        </div>
        <div class="wrapper">
            <span id="last"></span>
            <p>But now you've let some random text control you.</p>
        </div>
        <div class="yt-p">
            <div class="yt">
                <div id="player"></div>
            </div>
        </div>
        <div class="footer">
            <p>A web project by <a href="https://tomichen.com">Tomi Chen.</a></p>
        </div>
    </div>
    <script>
        // example from https://developers.google.com/youtube/iframe_api_reference
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
        var player;
        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
                videoId: 'dQw4w9WgXcQ',
                events: {
                    'onReady': onPlayerReady,
                }
            });
        }

        // 4. The API will call this function when the video player is ready.
        function onPlayerReady(event) {
            console.log("player ready")
        }

        // from https://stackoverflow.com/questions/123999/how-can-i-tell-if-a-dom-element-is-visible-in-the-current-viewport/7557433#7557433
        function isElementInViewport(el) {
            var rect = el.getBoundingClientRect();
            return (
                rect.top >= 0 &&
                rect.left >= 0 &&
                rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
                /* or $(window).height() */
                rect.right <= (window.innerWidth || document.documentElement
                    .clientWidth) /* or $(window).width() */
            );
        }

        var element = document.getElementById("last");
        function check(el, callback) {
            return function () {
                console.log("checking...")
                if (isElementInViewport(el)) {
                    callback();
                }
            }
        }

        var handler = check(element, function () {
            console.log("element in view")
            player.playVideo();
        });
        
        setInterval(handler, 100)

    </script>
    </div>
</body>

</html>